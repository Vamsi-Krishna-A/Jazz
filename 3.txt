[System.Reflection.Assembly]::LoadWithPartialName("System.windows.forms") | Out-Null

$OpenFileDialog = New-Object System.Windows.Forms.OpenFileDialog
$OpenFileDialog.initialDirectory = "C:\"
$OpenFileDialog.filter = "TXT (*.txt)| *.txt"
$OpenFileDialog.ShowDialog() | Out-Null
$File = $OpenFileDialog.filename
$Computers = Get-Content -Path $File
Foreach ($ComputerName in $Computers)
{
  $Sessions = Qwinsta /Server:$ComputerName
  $Rows = $Sessions[1..$($Sessions.Count -1)]
  Foreach ($r in $Rows)
  {
    If(($r.substring(48,8).Trim() -eq "Disc") -and ($r.substring(41,7).Trim() -ne "0"))
    {
      $ID = $r.substring(41,7).Trim()
      rwinsta /Server:$ComputerName $ID
    }
   }
 }
